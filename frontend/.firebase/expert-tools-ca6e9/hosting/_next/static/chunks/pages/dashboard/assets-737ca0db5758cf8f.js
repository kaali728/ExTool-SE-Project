(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[383],{9917:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/assets",function(){return t(9327)}])},1060:function(e,n,t){"use strict";t.d(n,{Uv:function(){return d},Zt:function(){return f},cT:function(){return h}});var r=t(4051),a=t.n(r),o=t(1153),i=t(7818),c=t(4931),s=t(5934);function u(e,n,t,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){u(o,r,a,i,c,"next",e)}function c(e){u(o,r,a,i,c,"throw",e)}i(void 0)}))}}function f(e,n){if(e){var t=new Map(Object.entries(e)),r={front:"",rightSide:"",leftSide:"",back:"",fuelGuage:"",hoursReading:""};return t.forEach(function(){var e=l(a().mark((function e(t,c){var u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=n.concat("".concat(c,"-").concat((0,s.Z)())),r[c]=u,l=(0,o.iH)(i.tO,u),e.next=5,h(l,t);case 5:console.log("".concat(c," image is uploaded"));case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),console.log(r),r}}function d(e,n){return p.apply(this,arguments)}function p(){return p=l(a().mark((function e(n,t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return r=[],n.map(function(){var e=l(a().mark((function e(n,c){var s,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.concat("-"+"".concat(c)),r.push(s),u=(0,o.iH)(i.tO,t.concat("-"+"".concat(c))),e.next=5,h(u,n);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),console.log(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function h(e,n){return v.apply(this,arguments)}function v(){return(v=l(a().mark((function e(n,t){var r,s,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={contentType:"image/jpeg"},(s=(0,o.B0)(n,t,r)).on(i.mC,(function(e){var n=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+n+"% done")}),(function(e){switch(e.code){case"storage/unauthorized":c.ZP.error("User doesn't have permission to access the object");break;case"storage/canceled":c.ZP.error("User canceled the upload")}})),e.next=5,s;case 5:return e.next=7,(0,o.Jt)(s.snapshot.ref);case 7:return u=e.sent,e.abrupt("return",u);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},1895:function(e,n,t){"use strict";t.d(n,{T0:function(){return h},cH:function(){return g},gz:function(){return d},pM:function(){return m}});var r=t(4051),a=t.n(r),o=t(5321),i=t(4931),c=t(7818);function s(e,n,t,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(r,a)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){s(o,r,a,i,c,"next",e)}function c(e){s(o,r,a,i,c,"throw",e)}i(void 0)}))}}function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){l(e,n,t[n])}))}return e}function d(e){return p.apply(this,arguments)}function p(){return(p=u(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.ET)((0,o.hJ)(c.RZ,"assets"),{name:n.name,serialNumber:n.serialNumber,imageUrl:n.imageUrl,time:n.time,status:n.status,table:n.table,engine:n.engine,location:n.location,machineHours:n.machineHours,diesel:n.diesel});case 2:return t=e.sent,console.log("Document written with ID: ",t.id),i.ZP.success("Asset created successfully"),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,n){return v.apply(this,arguments)}function v(){return(v=u(a().mark((function e(n,t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,o.JU)(c.RZ,"assets",n),e.next=3,(0,o.r7)(r,{table:t});case 3:i.ZP.success("Table saved");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,n){return x.apply(this,arguments)}function x(){return(x=u(a().mark((function e(n,t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,o.JU)(c.RZ,"assets",n),e.next=3,(0,o.r7)(r,f({},t));case 3:i.ZP.success("Api Fetched Data successfully saved");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return w.apply(this,arguments)}function w(){return(w=u(a().mark((function e(n){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/airfleet?sn=".concat(n));case 3:return t=e.sent,e.next=6,t.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),console.log("Error on Airefleet get status",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}},5045:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var r=t(7294);function a(e,n){(0,r.useEffect)((function(){return function(e){var n=!1,t=null;return e((function(){return n}),(function(e){t=e})),function(){n=!0,null!==t&&t()}}(e)}),n)}},2558:function(e,n,t){"use strict";var r,a,o;t.d(n,{BV:function(){return a},Q_:function(){return r},eD:function(){return o}}),function(e){e.CONFIRMED="Confirmed"}(r||(r={})),function(e){e.RUNNING="Running",e.STOPED="Stopped"}(a||(a={})),function(e){e.PICKUP="Pick up",e.DROP_OFF="Drop off",e.PICKEDUP="Picked up",e.DROPEDOFF="Droped off",e.ASSET_CREATED="Asset created",e.AWAITING_PAYMENT="Awaiting Payment"}(o||(o={}))},9327:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Z}});var r=t(4051),a=t.n(r),o=t(5893),i=t(8493),c=t(7294),s=t(5045),u=t(9473),l=t(9606);function f(e,n,t,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(r,a)}var d=function(){var e=function(){var e=r.toLowerCase().split(/\s+/g).filter((function(e){return e.length>0}));return Object.values(p).filter((function(n){var t=!0,r=!1,a=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var c=o.value;if(-1===n.name.indexOf(c))return!1}}catch(s){r=!0,a=s}finally{try{t||null==i.return||i.return()}finally{if(r)throw a}}return!0}))},n=(0,u.I0)(),t=(0,c.useState)(""),r=t[0],d=t[1],p=(0,u.v9)(l.XS);return(0,s.Z)(function(){var t,r=(t=a().mark((function t(r){var o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(n){n(e())}));case 2:if(o=t.sent,!r()){t.next=5;break}return t.abrupt("return");case 5:n((0,l.YX)(o));case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){f(o,r,a,i,c,"next",e)}function c(e){f(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[r,p]),(0,o.jsx)(i.kC,{style:{width:"350px"},children:(0,o.jsx)(i.II,{value:r,placeholder:"Looking for a asset?",scale:"l",onChange:function(e){var n=e.target.value;d(n)}})})},p=t(1153),h=t(4931),v=t(7818),m=t(1207),x=t.n(m),g=t(5934),w=t(1895),b=t(2558),y=t(2512),j=t(1060);function k(e,n,t,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(r,a)}function P(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){k(o,r,a,i,c,"next",e)}function c(e){k(o,r,a,i,c,"throw",e)}i(void 0)}))}}function O(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){O(e,n,t[n])}))}return e}var C=function(e){var n=e.openModal,t=e.setOpen,r=function(e){m((function(n){return _({},n,O({},e.target.name,e.target.value))})),e.preventDefault()},s=(0,u.I0)(),f=(0,c.useState)({name:"",serialNumber:"",diesel:""}),d=f[0],m=f[1],k=(0,c.useState)([{id:0,src:""}]),C=k[0],E=k[1];function D(){return(D=P(a().mark((function e(n){var r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),null!=C&&0!=d.serialNumber.length&&0!=d.name.length){e.next=4;break}return h.ZP.error("You need to add a picture, give the asset a name and add a serial number"),e.abrupt("return");case 4:return r=(0,p.iH)(v.tO,"assets/".concat(d.name,"/images/").concat(d.name+"_"+(0,g.Z)())),e.next=7,(0,j.cT)(r,N[0]);case 7:return o=e.sent,e.next=10,(0,w.gz)({id:"",name:d.name,serialNumber:d.serialNumber,imageUrl:o,status:b.Q_.CONFIRMED,time:0,table:[{date:(new Date).toString(),status:b.eD.ASSET_CREATED,destination:"",confirmed:!1}],engine:b.BV.STOPED,location:{long:0,lat:0},machineHours:0,diesel:d.diesel});case 10:s((0,l.HE)({changed:!0})),t(!1);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=(0,c.useCallback)((function(e){e.map((function(e,n){var t=new FileReader;return t.onload=function(e){E((function(t){return[{id:n,src:e.target.result}]}))},t.readAsDataURL(e),e}))}),[]),I=(0,y.uI)({onDrop:S}),N=I.acceptedFiles,R=I.getRootProps,Z=I.getInputProps;return(0,o.jsxs)(i.u_,{open:n,onClose:function(){t(!1)},_class:x().assetModal,scale:"xl",padding:"xl",type:"confirm",onConfirm:function(e){return D.apply(this,arguments)},children:[(0,o.jsx)(i.xv,{scale:"l",primary:!0,children:"New Asset"}),(0,o.jsx)(i.II,{name:"name",value:d.name,placeholder:"Name of your Asset",onChange:r}),(0,o.jsx)(i.LZ,{}),(0,o.jsx)(i.II,{name:"serialNumber",placeholder:"S/N",value:d.serialNumber,onChange:r}),(0,o.jsx)(i.LZ,{}),(0,o.jsx)(i.II,{name:"diesel",type:"number",placeholder:"Fuel volumn",value:d.diesel,onChange:r}),(0,o.jsx)(i.LZ,{}),(0,o.jsxs)("div",_({},R({className:"dropzone"}),{style:{border:"2px dashed var(--text300)",padding:"10px",borderRadius:"var(--borderRadius)"},children:[(0,o.jsx)("input",_({},Z())),(0,o.jsx)(i.xv,{padding:"xl",align:"center",children:"Drag 'n' drop, or click to select files"})]})),(0,o.jsx)(i.LZ,{}),(0,o.jsx)(i.Ee,{src:C[0].src})]})},E=t(5321),D=t(1163),S=t(2215);function I(e,n,t,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(r,a)}function N(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){N(e,n,t[n])}))}return e}var Z=function(){var e=(0,u.I0)(),n=(0,c.useState)(!1),t=n[0],r=n[1],s=(0,u.v9)(l.XS),f=(0,u.v9)(l.Bs),p=(0,u.v9)(l.ct),m=(0,D.useRouter)(),g=(0,c.useState)([]),w=g[0],b=g[1];return(0,c.useEffect)((function(){var n=!0,t=[],r=function(){var r,o=(r=a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,E.PL)((0,E.hJ)(v.RZ,"assets"));case 2:r.sent.forEach((function(e){t.push(R({id:e.id},e.data()))})),n&&(e((0,l.c7)(t)),e((0,l.HE)({changed:!1})));case 5:case"end":return r.stop()}}),r)})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(e){I(o,t,a,i,c,"next",e)}function c(e){I(o,t,a,i,c,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}();return r().catch((function(e){h.ZP.error("Something went wrong!"),console.log("error",e)})),function(){return n=!1}}),[p]),(0,c.useEffect)((function(){f.length>0?b(f):b(s)}),[f,s]),(0,o.jsx)(i.kC,{padding:"xl",children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.kC,{children:(0,o.jsx)(i.xv,{style:{fontSize:"35px"},weight:"bold",children:"My Assets"})}),(0,o.jsxs)(i.kC,{style:{padding:"3.5rem 0px"},children:[(0,o.jsxs)(i.kC,{flexDirection:"row",alignItems:"center",flexWrap:"wrap",children:[(0,o.jsx)(d,{}),(0,o.jsx)(i.zx,{scale:"l",primary:!0,onClick:function(){return r(!0)},children:"Add Asset"}),(0,o.jsx)(C,{openModal:t,setOpen:r})]}),(0,o.jsx)(i.LZ,{}),(0,o.jsx)(i.rj,{_class:x().assetsGrid,children:w.map((function(e,n){return(0,o.jsxs)(i.Zb,{pointer:!0,margin:"0",padding:"xl",onClick:function(){m.push("".concat(S.ou,"/").concat(e.id))},children:[(0,o.jsx)(i.Ee,{src:e.imageUrl}),(0,o.jsxs)(i.Ol,{padding:"0",margin:"0",children:[(0,o.jsx)(i.xv,{scale:"xl",weight:"bold",margin:"xl m m m",children:e.name}),(0,o.jsx)(i.Vp,{children:[(0,o.jsxs)(i.kC,{alignItems:"center",flexDirection:"row",children:[(0,o.jsxs)("svg",{id:"Component_34_8","data-name":"Component 34 \u2013 8",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 15 15",children:[(0,o.jsx)("g",{id:"Component_33_20","data-name":"Component 33 \u2013 20",children:(0,o.jsx)("rect",{id:"Rectangle_6659","data-name":"Rectangle 6659",width:"15",height:"15",fill:"none"})}),(0,o.jsxs)("g",{id:"Icon_feather-clock","data-name":"Icon feather-clock",transform:"translate(-2 -2)",children:[(0,o.jsx)("path",{id:"Path_1179","data-name":"Path 1179",d:"M15.971,9.486A6.486,6.486,0,1,1,9.486,3,6.486,6.486,0,0,1,15.971,9.486Z",fill:"none",stroke:"var(--text200)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),(0,o.jsx)("path",{id:"Path_1180","data-name":"Path 1180",d:"M18,9v3.891l2.594,1.3",transform:"translate(-8.514 -3.406)",fill:"none",stroke:"var(--text200)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})]}),(0,o.jsx)(i.xv,{padding:"0 0 0 s",margin:"0",children:e.time})]},1),(0,o.jsxs)(i.kC,{alignItems:"center",flexDirection:"row",children:[(0,o.jsxs)("svg",{id:"Component_35_5","data-name":"Component 35 \u2013 5",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 15 15",children:[(0,o.jsx)("g",{id:"Component_34_9","data-name":"Component 34 \u2013 9",children:(0,o.jsx)("g",{id:"Component_33_20","data-name":"Component 33 \u2013 20",children:(0,o.jsx)("rect",{id:"Rectangle_6659","data-name":"Rectangle 6659",width:"15",height:"15",fill:"none"})})}),(0,o.jsx)("line",{id:"Line_1057","data-name":"Line 1057",x2:"3.052",y2:"3.446",transform:"translate(2.947 8.036)",fill:"none",stroke:"var(--text200)",strokeLinecap:"round",strokeWidth:"2.5"}),(0,o.jsx)("line",{id:"Line_1058","data-name":"Line 1058",x1:"6.452",y2:"7.039",transform:"translate(5.999 4.442)",fill:"none",stroke:"var(--text200)",strokeLinecap:"round",strokeWidth:"2.5"})]}),(0,o.jsx)(i.xv,{padding:"0 0 0 s",margin:"0",children:e.status})]},2)]})]})]},n)}))})]})]})})}}},function(e){e.O(0,[339,774,888,179],(function(){return n=9917,e(e.s=n);var n}));var n=e.O();_N_E=n}]);