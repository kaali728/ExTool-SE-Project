(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{5374:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/assets/[id]",function(){return t(1890)}])},1060:function(e,n,t){"use strict";t.d(n,{Uv:function(){return f},Zt:function(){return d},cT:function(){return h}});var r=t(4051),i=t.n(r),a=t(1153),o=t(7818),s=t(4931),c=t(5934);function u(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)}))}}function d(e,n){if(e){var t=new Map(Object.entries(e)),r={front:"",rightSide:"",leftSide:"",back:"",fuelGuage:"",hoursReading:""};return t.forEach(function(){var e=l(i().mark((function e(t,s){var u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=n.concat("".concat(s,"-").concat((0,c.Z)())),r[s]=u,l=(0,a.iH)(o.tO,u),e.next=5,h(l,t);case 5:console.log("".concat(s," image is uploaded"));case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),console.log(r),r}}function f(e,n){return x.apply(this,arguments)}function x(){return x=l(i().mark((function e(n,t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return r=[],n.map(function(){var e=l(i().mark((function e(n,s){var c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.concat("-"+"".concat(s)),r.push(c),u=(0,a.iH)(o.tO,t.concat("-"+"".concat(s))),e.next=5,h(u,n);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),console.log(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function h(e,n){return p.apply(this,arguments)}function p(){return(p=l(i().mark((function e(n,t){var r,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={contentType:"image/jpeg"},(c=(0,a.B0)(n,t,r)).on(o.mC,(function(e){var n=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+n+"% done")}),(function(e){switch(e.code){case"storage/unauthorized":s.ZP.error("User doesn't have permission to access the object");break;case"storage/canceled":s.ZP.error("User canceled the upload")}})),e.next=5,c;case 5:return e.next=7,(0,a.Jt)(c.snapshot.ref);case 7:return u=e.sent,e.abrupt("return",u);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},1895:function(e,n,t){"use strict";t.d(n,{T0:function(){return h},cH:function(){return v},gz:function(){return f},pM:function(){return m}});var r=t(4051),i=t.n(r),a=t(5321),o=t(4931),s=t(7818);function c(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){c(a,r,i,o,s,"next",e)}function s(e){c(a,r,i,o,s,"throw",e)}o(void 0)}))}}function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){l(e,n,t[n])}))}return e}function f(e){return x.apply(this,arguments)}function x(){return(x=u(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.ET)((0,a.hJ)(s.RZ,"assets"),{name:n.name,serialNumber:n.serialNumber,imageUrl:n.imageUrl,time:n.time,status:n.status,table:n.table,engine:n.engine,location:n.location,machineHours:n.machineHours,diesel:n.diesel});case 2:return t=e.sent,console.log("Document written with ID: ",t.id),o.ZP.success("Asset created successfully"),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,n){return p.apply(this,arguments)}function p(){return(p=u(i().mark((function e(n,t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,a.JU)(s.RZ,"assets",n),e.next=3,(0,a.r7)(r,{table:t});case 3:o.ZP.success("Table saved");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,n){return g.apply(this,arguments)}function g(){return(g=u(i().mark((function e(n,t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,a.JU)(s.RZ,"assets",n),e.next=3,(0,a.r7)(r,d({},t));case 3:o.ZP.success("Api Fetched Data successfully saved");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return j.apply(this,arguments)}function j(){return(j=u(i().mark((function e(n){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/airfleet?sn=".concat(n));case 3:return t=e.sent,e.next=6,t.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),console.log("Error on Airefleet get status",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}},5045:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(7294);function i(e,n){(0,r.useEffect)((function(){return function(e){var n=!1,t=null;return e((function(){return n}),(function(e){t=e})),function(){n=!0,null!==t&&t()}}(e)}),n)}},2558:function(e,n,t){"use strict";var r,i,a;t.d(n,{BV:function(){return i},Q_:function(){return r},eD:function(){return a}}),function(e){e.CONFIRMED="Confirmed"}(r||(r={})),function(e){e.RUNNING="Running",e.STOPED="Stopped"}(i||(i={})),function(e){e.PICKUP="Pick up",e.DROP_OFF="Drop off",e.PICKEDUP="Picked up",e.DROPEDOFF="Droped off",e.ASSET_CREATED="Asset created",e.AWAITING_PAYMENT="Awaiting Payment"}(a||(a={}))},1890:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Ce}});var r=t(4051),i=t.n(r),a=t(5893),o=t(8493),s=t(5152),c=t(1163),u=t(7294);function l(){return(0,a.jsx)("div",{children:"Availiblity"})}function d(){return(0,a.jsx)("div",{children:"Contracts"})}function f(){return(0,a.jsx)("div",{children:"Gallery"})}var x=t(1207),h=t.n(x),p=t(4799),m=t(7320),g=t.n(m),v=t(6893),j=t(1895),b=t(9473),y=t(9606),w=t(2558),k=t(5934),C=t(4931),P=t(4385);function O(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function S(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function N(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){S(a,r,i,o,s,"next",e)}function s(e){S(a,r,i,o,s,"throw",e)}o(void 0)}))}}function D(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){D(e,n,t[n])}))}return e}function R(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return O(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return O(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e){var n=e.open,t=e.setOpen,r=e.onSubmit,s=e.save,c=e.title,l=e.selectedCellData,d=((0,b.I0)(),(0,u.useRef)(null)),f=(0,u.useState)(!1),x=f[0],h=f[1];(0,u.useEffect)((function(){x&&(s(),h(!1))}),[x]);var p=(0,u.useState)({destination:"",date:"",report:"",officeNotes:[{text:"",checked:!1}],confirmed:!1,status:""}),m=p[0],g=p[1];(0,u.useEffect)((function(){l&&g({destination:l.destination,date:l.date,report:l.report,officeNotes:l.officeNotes?l.officeNotes:[],confirmed:l.confirmed,status:l.status})}),[l]);var v=function(e){var n=e.target,t=n.name,r=n.value;if(t.includes("officeNote")){var i=Number(t.replace("officeNote",""));g((function(e){return I({},e,{officeNotes:e.officeNotes.map((function(e,n){return n===i?{text:r,checked:!1}:e}))})}))}else g((function(e){return I({},e,D({},t,r))}))},j=function(){var e=N(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Select"!==m.status&&""!==m.status){e.next=3;break}return C.ZP.error("Please select a status!"),e.abrupt("return",!0);case 3:if(""!==m.destination){e.next=6;break}return C.ZP.error("Please pick a destination!"),e.abrupt("return",!0);case 6:if(""!==m.date){e.next=9;break}return C.ZP.error("Please pick a date and time!"),e.abrupt("return",!0);case 9:return r({date:m.date,status:m.status,destination:m.destination,confirmed:m.confirmed,officeNotes:m.officeNotes}),h(!0),g({destination:"",date:"",report:"",officeNotes:[],confirmed:!1,status:""}),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){d.current&&(0,P.ZP)(d.current)}),[d]),(0,a.jsxs)(o.u_,{open:n,onClose:function(){t(!1)},type:"confirm",onConfirm:N(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e)}))),children:[(0,a.jsx)(o.xv,{weight:"bold",scale:"xl",children:c}),(0,a.jsxs)(o.kC,{children:[(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Status"}),(0,a.jsxs)("select",{name:"status",onChange:v,value:m.status,children:[(0,a.jsx)("option",{value:"Select",children:"Select"}),(0,a.jsx)("option",{value:w.eD.PICKUP,children:w.eD.PICKUP}),(0,a.jsx)("option",{value:w.eD.DROP_OFF,children:w.eD.DROP_OFF}),(0,a.jsx)("option",{value:w.eD.AWAITING_PAYMENT,children:w.eD.AWAITING_PAYMENT})]}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Destination"}),(0,a.jsx)(o.II,{name:"destination",value:m.destination,onChange:v}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Date"}),(0,a.jsx)(o.II,{name:"date",type:"datetime-local",value:m.date,onChange:v}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Office Notes"}),(0,a.jsx)("div",{ref:d,children:m.officeNotes.map((function(e,n){return(0,a.jsxs)("div",{children:[(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,a.jsx)("span",{}),(0,a.jsx)(o.zx,{onClick:function(){var e=m.officeNotes;e.splice(n,1),g((function(n){return I({},n,{officeNotes:e})}))},scale:"s",margin:"m 0",children:"Remove"})]}),(0,a.jsx)("textarea",{name:"officeNote"+n,value:e.text,onChange:v},n)]},n)}))}),(0,a.jsx)(o.zx,{onClick:function(){g((function(e){return I({},e,{officeNotes:R(e.officeNotes).concat([{text:"",checked:!1}])})}))},children:"+ Add office note"})]})]})}var E=t(7818),_=t(5045),Z=t(5675),U=t.n(Z),T=t(5155);function F(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function M(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){F(a,r,i,o,s,"next",e)}function s(e){F(a,r,i,o,s,"throw",e)}o(void 0)}))}}function H(e){var n,t=e.open,r=e.setOpen,s=e.cellData,c=(0,u.useState)({front:"",rightSide:"",leftSide:"",back:"",fuelGuage:"",hoursReading:""}),l=c[0],d=c[1],f=(0,u.useState)([]),x=f[0],h=f[1];return(0,_.Z)(M(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.images){e.next=22;break}return e.t0=d,e.next=4,(0,E.nZ)(s.images.front);case 4:return e.t1=e.sent,e.next=7,(0,E.nZ)(s.images.rightSide);case 7:return e.t2=e.sent,e.next=10,(0,E.nZ)(s.images.leftSide);case 10:return e.t3=e.sent,e.next=13,(0,E.nZ)(s.images.back);case 13:return e.t4=e.sent,e.next=16,(0,E.nZ)(s.images.fuelGuage);case 16:return e.t5=e.sent,e.next=19,(0,E.nZ)(s.images.hoursReading);case 19:e.t6=e.sent,e.t7={front:e.t1,rightSide:e.t2,leftSide:e.t3,back:e.t4,fuelGuage:e.t5,hoursReading:e.t6},(0,e.t0)(e.t7);case 22:case"end":return e.stop()}}),e)}))),[]),(0,_.Z)(M(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.additionalImages&&s.additionalImages.length>0&&(console.log(x),n=[],s.additionalImages.map(function(){var e=M(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,E.nZ)(t);case 2:r=e.sent,n.push(r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),h(n));case 1:case"end":return e.stop()}}),e)}))),[s]),(0,a.jsxs)(o.u_,{open:t,onClose:function(){r(!1)},type:"confirm",children:[(0,a.jsx)(o.xv,{weight:"bold",scale:"xl",children:s.status}),(0,a.jsxs)(o.kC,{children:[(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Address"}),(0,a.jsx)(o.xv,{weight:"bold",children:s.destination}),(0,a.jsx)(o.xv,{href:"https://maps.google.com/?q=".concat(s.destination),children:(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",children:[(0,a.jsx)(T.fp2,{className:g().icon}),(0,a.jsx)(o.xv,{margin:"0 0 0 m",padding:"0",children:"Open map"})]})}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Date"}),(0,a.jsx)(o.xv,{weight:"bold",children:s.date}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Report"}),(0,a.jsx)(o.xv,{weight:"bold",children:s.report}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Hours"}),(0,a.jsx)(o.xv,{weight:"bold",children:s.hours}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Diesel"}),(0,a.jsx)(o.xv,{weight:"bold",children:s.diesel}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Office Notes"}),null===(n=s.officeNotes)||void 0===n?void 0:n.map((function(e,n){return(0,a.jsxs)(o.kC,{flexDirection:"row",children:[(0,a.jsx)("input",{type:"checkbox",value:e.checked}),(0,a.jsx)(o.xv,{margin:"m",weight:"bold",children:e.text})]},n)}))]}),s.confirmed&&(0,a.jsx)("div",{className:"imageContainer",children:(0,a.jsxs)(o.kC,{children:[(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Pictures"}),""!==l.front&&(0,a.jsxs)(o.rj,{children:[(0,a.jsxs)(o.Zb,{pointer:!0,margin:"0",children:[(0,a.jsx)(o.Ol,{margin:"0",children:(0,a.jsx)("a",{href:l.hoursReading,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(U(),{width:200,height:200,src:l.front})})}),(0,a.jsx)(o.aY,{margin:"0",children:(0,a.jsx)(o.xv,{margin:"0 0 l 0",align:"center",children:"Front"})})]}),(0,a.jsxs)(o.Zb,{pointer:!0,margin:"0",children:[(0,a.jsx)(o.Ol,{margin:"0",children:(0,a.jsx)("a",{href:l.hoursReading,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(U(),{width:200,height:200,src:l.back})})}),(0,a.jsx)(o.aY,{margin:"0",children:(0,a.jsx)(o.xv,{margin:"0 0 l 0",align:"center",children:"Back"})})]}),(0,a.jsxs)(o.Zb,{pointer:!0,margin:"0",children:[(0,a.jsx)(o.Ol,{margin:"0",children:(0,a.jsx)("a",{href:l.hoursReading,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(U(),{width:200,height:200,src:l.rightSide})})}),(0,a.jsx)(o.aY,{margin:"0",children:(0,a.jsx)(o.xv,{margin:"0 0 l 0",align:"center",children:"Right side"})})]}),(0,a.jsxs)(o.Zb,{pointer:!0,margin:"0",children:[(0,a.jsx)(o.Ol,{margin:"0",children:(0,a.jsx)("a",{href:l.hoursReading,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(U(),{width:200,height:200,src:l.leftSide})})}),(0,a.jsx)(o.aY,{margin:"0",children:(0,a.jsx)(o.xv,{margin:"0 0 l 0",align:"center",children:"Left side"})})]}),(0,a.jsxs)(o.Zb,{pointer:!0,margin:"0",children:[(0,a.jsx)(o.Ol,{margin:"0",children:(0,a.jsx)("a",{href:l.hoursReading,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(U(),{width:200,height:200,src:l.hoursReading})})}),(0,a.jsx)(o.aY,{margin:"0",children:(0,a.jsx)(o.xv,{margin:"0 0 l 0",align:"center",children:"Hours reading"})})]}),(0,a.jsxs)(o.Zb,{pointer:!0,margin:"0",children:[(0,a.jsx)(o.Ol,{margin:"0",children:(0,a.jsx)("a",{href:l.hoursReading,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(U(),{width:200,height:200,src:l.fuelGuage})})}),(0,a.jsx)(o.aY,{margin:"0",children:(0,a.jsx)(o.xv,{margin:"0 0 l 0",align:"center",children:"Fuel guage"})})]})]})]})}),x.length>0?(0,a.jsx)(o.hJ,{margin:"xl 0",showPaginate:!0,children:x.map((function(e,n){return(0,a.jsx)(U(),{src:e},n)}))}):null]})}function L(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function G(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function z(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function V(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,a=[],o=!0,s=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);o=!0);}catch(c){s=!0,i=c}finally{try{o||null==t.return||t.return()}finally{if(s)throw i}}return a}}(e,n)||B(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,n){if(e){if("string"===typeof e)return L(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?L(e,n):void 0}}var J=(0,p.createTable)().setRowType().setTableMetaType(),Y={cell:function(e){var n=e.getValue,t=e.row.index,r=e.column.id,i=e.instance,o=n(),s=(0,u.useState)(o),c=s[0],l=s[1];return u.useEffect((function(){l(o)}),[o]),(0,a.jsx)("input",{value:c,onChange:function(e){return l(e.target.value)},onBlur:function(){var e;null===(e=i.options.meta)||void 0===e||e.updateData(t,r,c)}})}};function W(e){var n=e._data,t=(0,b.I0)(),r=(0,b.v9)(y.QU),s=(0,u.useState)(null===r||void 0===r?void 0:r.table),c=s[0],l=s[1],d=(0,u.useState)(!1),f=d[0],x=d[1],h=(0,u.useState)(!1),m=h[0],C=h[1],P=(0,u.useState)(!1),O=P[0],S=P[1],N=(0,u.useState)(!1),D=N[0],I=N[1],R=(0,u.useState)(!1),E=R[0],_=R[1],Z=(0,u.useState)(),U=Z[0],T=Z[1],F=(0,u.useState)(),M=F[0],L=F[1],B=V(function(){var e=u.useRef(!0),n=e.current,t=u.useCallback((function(){e.current=!1}),[]);return u.useEffect((function(){e.current=!0})),[n,t]}(),2),W=B[0],q=B[1];if((0,u.useEffect)((function(){X.setPageSize(Number(20))}),[]),void 0===c)return(0,a.jsx)(a.Fragment,{});var $=u.useMemo((function(){return[J.createDataColumn((function(e){return e.date}),{id:"date",header:function(){return(0,a.jsx)("span",{children:"Date"})},footer:function(e){return e.column.id},cell:function(e){var n=e.cell;return(0,a.jsx)(o.kC,{children:(0,a.jsx)("input",{onChange:function(e){var t;return null===(t=X.options.meta)||void 0===t?void 0:t.updateData(n.row.index,"date",e.target.value)},value:n.getValue(),type:"datetime-local",id:"input"})})}}),J.createDataColumn((function(e){return e.status}),{id:"status",header:function(){return(0,a.jsx)("span",{children:"Status"})},cell:function(e){var n,t=e.cell;return(0,a.jsx)(o.kC,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:(null===(n=t.row.original)||void 0===n?void 0:n.confirmed)||t.getValue()===w.eD.PICKEDUP||t.getValue()===w.eD.DROPEDOFF?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.xv,{_class:t.getValue()===w.eD.PICKEDUP||t.getValue()===w.eD.AWAITING_PAYMENT?g().pickedUpCell:g().dropedOffCell,children:t.getValue()}),(0,a.jsx)(v.AlO,{style:{cursor:"pointer"},onClick:function(){T(t.row.original),I(!0)}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.xv,{children:t.getValue()}),(0,a.jsx)("svg",{onClick:function(){console.log(t.row.index),L(t.row.index),T(t.row.original),_(!0)},xmlns:"http://www.w3.org/2000/svg",width:"11.756",height:"11.756",viewBox:"0 0 11.756 11.756",children:(0,a.jsx)("path",{id:"Icon_material-edit","data-name":"Icon material-edit",d:"M4.5,13.8v2.449H6.949L14.171,9.03,11.722,6.581ZM16.065,7.136a.65.65,0,0,0,0-.921L14.537,4.687a.65.65,0,0,0-.921,0l-1.2,1.2L14.87,8.331Z",transform:"translate(-4.5 -4.496)",fill:"var(--text200)"})})]})})},footer:function(e){return e.column.id},size:10}),J.createDataColumn((function(e){return null===e||void 0===e?void 0:e.destination}),{id:"destination",header:function(){return(0,a.jsx)("span",{children:"Destination"})},footer:function(e){return e.column.id}})]}),[]),X=(0,p.useTableInstance)(J,{data:c,columns:$,defaultColumn:Y,getCoreRowModel:(0,p.getCoreRowModel)(),getFilteredRowModel:(0,p.getFilteredRowModel)(),getPaginationRowModel:(0,p.getPaginationRowModel)(),autoResetPageIndex:W,meta:{updateData:function(e,n,t){q(),l((function(r){return r.map((function(i,a){return a===e?function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){z(e,n,t[n])}))}return e}({},r[e],z({},n,t)):i}))}))}},debugTable:!0});(0,u.useEffect)((function(){l(null===r||void 0===r?void 0:r.table)}),[r]);var ee=function(){var e,r=(e=i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.T0)(n.id,c);case 2:t((0,y.Lq)({table:c})),x(!1);case 4:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){G(a,r,i,o,s,"next",e)}function s(e){G(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}();return(0,u.useEffect)((function(){c&&C(!0),m&&x(!0)}),[c]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:g().table,children:[(0,a.jsxs)(o.kC,{flexDirection:"row",justifyContent:"space-between",padding:"0 0 m 0",children:[(0,a.jsx)(o.xv,{weight:"bold",scale:"xl",margin:"m 0 xl 0",children:"Delivery Schedule"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.zx,{onClick:function(){return S(!0)},children:"Add"}),f&&(0,a.jsx)(o.zx,{primary:!0,onClick:ee,margin:"0",children:"Save"})]})]}),(0,a.jsx)("div",{style:{overflow:"auto"},children:(0,a.jsxs)("table",{style:{width:"100%"},children:[(0,a.jsx)("thead",{children:X.getHeaderGroups().map((function(e){return(0,a.jsx)("tr",{children:e.headers.map((function(e){return(0,a.jsx)("th",{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,a.jsxs)("div",{children:[e.renderHeader(),e.column.getCanFilter()?(0,a.jsx)("div",{children:(0,a.jsx)(Q,{column:e.column,instance:X})}):null]})},e.id)}))},e.id)}))}),(0,a.jsx)("tbody",{children:X.getRowModel().rows.map((function(e){return(0,a.jsx)("tr",{children:e.getVisibleCells().map((function(e){return(0,a.jsx)("td",{children:e.renderCell()},e.id)}))},e.id)}))})]})}),(0,a.jsxs)(o.kC,{flexDirection:"row",justifyContent:"space-between",margin:"xl 0",children:[(0,a.jsx)(o.zx,{onClick:function(){return X.setPageIndex(0)},disabled:!X.getCanPreviousPage(),children:(0,a.jsx)(v.q5n,{})}),(0,a.jsx)(o.zx,{onClick:function(){return X.previousPage()},disabled:!X.getCanPreviousPage(),children:(0,a.jsx)(v.Ao2,{})}),(0,a.jsxs)(o.xv,{align:"center",children:[(0,a.jsx)("div",{children:"Page"}),(0,a.jsxs)("strong",{children:[X.getState().pagination.pageIndex+1," of"," ",X.getPageCount()]})]}),(0,a.jsx)(o.zx,{onClick:function(){return X.nextPage()},disabled:!X.getCanNextPage(),children:(0,a.jsx)(v.Rgz,{})}),(0,a.jsx)(o.zx,{onClick:function(){return X.setPageIndex(X.getPageCount()-1)},disabled:!X.getCanNextPage(),children:(0,a.jsx)(v.OtR,{})})]})]}),(0,a.jsx)(A,{title:"Add new row",open:O,setOpen:S,onSubmit:function(e){!function(e){var n=e.date,t=e.status,r=e.destination,i=e.confirmed,a=e.officeNotes;l((function(e){return[{id:(0,k.Z)(),date:n,status:t,destination:r,confirmed:i,officeNotes:a}].concat(K(e))}))}({date:e.date,status:e.status,destination:e.destination,confirmed:e.confirmed,officeNotes:e.officeNotes})},save:function(){return ee()}}),(0,a.jsx)(A,{title:"Edit row",open:E,setOpen:_,onSubmit:function(e){var n;n=e,l((function(e){return e.map((function(e,t){return t===M?n:e}))}))},save:function(){return ee()},selectedCellData:U}),U&&(0,a.jsx)(H,{open:D,setOpen:I,cellData:U})]})}function Q(e){var n,t=e.column,r=(null===(n=e.instance.getPreFilteredRowModel().flatRows[0])||void 0===n||n.getValue(t.id),t.getFilterValue());return"date"===t.id?(0,a.jsx)("input",{type:"date",value:null!==r&&void 0!==r?r:"",onChange:function(e){return t.setFilterValue(e.target.value)},placeholder:"Search..."}):(0,a.jsx)("input",{type:"text",value:null!==r&&void 0!==r?r:"",onChange:function(e){return t.setFilterValue(e.target.value)},placeholder:"Search...",className:"w-36 border shadow rounded"})}var q=t(6653),$=t(9583);function X(){var e=(0,u.useState)(),n=e[0],t=e[1],r=(0,b.v9)(y.QU);return(0,u.useEffect)((function(){fetch("https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=".concat(null===r||void 0===r?void 0:r.location.lat,"&lon=").concat(null===r||void 0===r?void 0:r.location.long)).then((function(e){return e.json()})).then((function(e){t(e.display_name)}))}),[r]),(0,a.jsxs)(o.kC,{_class:h().overview,flexDirection:"row",justifyContent:"space-between",children:[(0,a.jsxs)("div",{className:h().stats+" "+h().tabsContainer,children:[(0,a.jsx)(o.xv,{weight:"bold",children:(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",children:[(0,a.jsx)(q.Sw5,{style:{marginRight:"10px"}}),"Current Location:"]})}),(0,a.jsx)(o.xv,{children:n}),(0,a.jsx)(o.LZ,{}),(0,a.jsx)(o.xv,{weight:"bold",children:(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",children:[(0,a.jsx)($.F9M,{style:{marginRight:"10px"}}),"Engine:"]})}),(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",children:[r&&"Running"===r.engine?(0,a.jsx)("div",{className:h().runningAnimation}):(0,a.jsx)("div",{className:h().offline}),(0,a.jsx)(o.xv,{margin:"0 0 0 l",children:r&&r.engine})]}),(0,a.jsx)(o.LZ,{}),(0,a.jsx)(o.xv,{weight:"bold",children:(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",children:[(0,a.jsx)(v.TCC,{style:{marginRight:"10px"}}),"Machine Hours:"]})}),(0,a.jsxs)(o.xv,{children:[r&&r.machineHours," hours"]})]}),(0,a.jsx)("div",{className:h().table+" "+h().tabsContainer,children:(0,a.jsx)(W,{_data:r})})]})}function ee(){return(0,a.jsx)("div",{children:"Service"})}console.log("date",(new Date).toString());var ne=t(5321),te=t(2512),re=t(1060),ie=t(7537),ae=t.n(ie);function oe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function se(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function ce(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){se(a,r,i,o,s,"next",e)}function s(e){se(a,r,i,o,s,"throw",e)}o(void 0)}))}}function ue(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function le(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ue(e,n,t[n])}))}return e}function de(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return oe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oe(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e){var n=e.open,t=e.setOpen,r=(e.data,(0,b.I0)()),s=(0,u.useState)({destination:"",date:"",report:"",officeNotes:[],diesel:0,hours:0,confirmed:!1}),c=s[0],l=s[1],d=(0,u.useState)([]),f=d[0],x=d[1],h=(0,u.useState)({front:null,rightSide:null,leftSide:null,back:null,fuelGuage:null,hoursReading:null}),p=h[0],m=h[1],g=(0,u.useState)(!1),v=g[0],P=g[1],O=(0,b.v9)(y.QU),S=(0,u.useCallback)((function(e){e.map((function(e,n){var t=new FileReader;return t.onload=function(e){x((function(t){return de(t).concat([{id:n,src:e.target.result}])}))},t.readAsDataURL(e),e}))}),[]),N=(0,te.uI)({onDrop:S}),D=N.acceptedFiles,I=N.getRootProps,R=N.getInputProps;(0,u.useEffect)((function(){if(n&&null!==O){var e=O.table.find((function(e,n){if(e.status===w.eD.PICKUP)return{date:e.date,destination:e.destination,officeNotes:e.officeNotes,index:n}}));if(void 0===e)return;l((function(n){return le({},n,{date:e.date,destination:e.destination,officeNotes:e.officeNotes})}))}}),[O,n]),(0,_.Z)(function(){var e=ce(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v||null===O){e.next=8;break}return e.next=3,(0,j.T0)(O.id,O.table);case 3:P(!1),x([]),l({destination:"",date:"",report:"",officeNotes:[],diesel:0,hours:0,confirmed:!1}),m({front:null,rightSide:null,leftSide:null,back:null,fuelGuage:null,hoursReading:null}),D.splice(0,D.length);case 8:if(!n()){e.next=10;break}return e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[v]);var A=function(e){var n=e.target,t=n.name,r=n.value,i=n.checked;if(t.includes("officeNotes")){var a=Number(t.replace("officeNotes",""));l((function(e){return le({},e,{officeNotes:e.officeNotes.map((function(e,n){return n===a?le({},e,{checked:i}):e}))})}))}else switch(t){case"diesel":case"hours":l((function(e){return le({},e,ue({},t,parseInt(r)))}));break;default:l((function(e){return le({},e,ue({},t,r))}))}},E=function(){var e=ce(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.officeNotes.map((function(e){return e.checked})).includes(!1)){e.next=3;break}return C.ZP.error("Accept the office note!"),e.abrupt("return",!0);case 3:if(!Object.values(p).map((function(e){return null===e})).includes(!0)){e.next=6;break}return C.ZP.error("Please upload all Pictures"),e.abrupt("return",!0);case 6:return e.next=8,(0,re.Zt)(p,"assets/".concat(null===O||void 0===O?void 0:O.name,"/images/pickups-").concat(c.date,"/pictures/pick-up-").concat(c.date));case 8:return n=e.sent,e.next=11,(0,re.Uv)(D,"assets/".concat(null===O||void 0===O?void 0:O.name,"/images/pickups-").concat(c.date,"/additionalImages/pick-up-").concat(c.date,"-").concat((0,k.Z)()));case 11:if(t=e.sent,void 0!=n&&void 0!=t){e.next=15;break}return C.ZP.error("Could not upload Images!"),e.abrupt("return",!0);case 15:return r((0,y.E0)({tableContent:{date:c.date,destination:c.destination,status:w.eD.PICKEDUP,images:n,additionalImages:t,diesel:c.diesel,hours:c.hours,officeNotes:c.officeNotes,report:c.report,confirmed:!0}})),P(!0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(e){var n=e.name,t=(e.index,(0,u.useRef)(null));return(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,a.jsx)(o.JO,{style:p[n]?{}:{visibility:"hidden"},padding:"m",pointer:!0,icon:"cross",onClick:function(){return m((function(e){return le({},e,ue({},n,null))})),void(t.current&&(t.current.value=""))}}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,a.jsxs)(o.xv,{margin:"0 l 0 0",children:[n,":"]}),(0,a.jsx)("img",{src:p[n]?URL.createObjectURL(p[n]):"",width:40,height:40,style:p[n]?{borderRadius:"5px",margin:"5px",objectFit:"cover"}:{display:"none"}})]}),(0,a.jsx)("input",{style:{width:"200px",backgroundColor:"var(--bg300)"},ref:t,type:"file",onChange:function(e){m((function(e){return le({},e,ue({},n,t.current.files[0]))}))}})]})};return(0,a.jsxs)(o.u_,{open:n,onClose:function(){t(!1)},type:"confirm",onConfirm:ce(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e)}))),children:[(0,a.jsx)(o.xv,{weight:"bold",scale:"xl",children:"Pickup"}),(0,a.jsxs)(o.kC,{children:[(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Address"}),(0,a.jsx)(o.xv,{weight:"bold",children:c.destination}),(0,a.jsx)(o.xv,{href:"https://maps.google.com/?q=".concat(c.destination),children:(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",children:[(0,a.jsx)(T.fp2,{className:ae().icon}),(0,a.jsx)(o.xv,{margin:"0 0 0 m",padding:"0",children:"Open map"})]})}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Date"}),(0,a.jsx)(o.xv,{weight:"bold",children:c.date}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Pictures"}),Object.keys(p).map((function(e,n){return(0,a.jsx)(Z,{name:e,index:n},e)})),(0,a.jsx)(o.xv,{scale:"s",children:"Additional Pictures"}),(0,a.jsxs)("div",le({},I({className:"dropzone"}),{style:{border:"2px dashed var(--text300)",padding:"10px",borderRadius:"var(--borderRadius)"},children:[(0,a.jsx)("input",le({},R())),(0,a.jsx)(o.xv,{padding:"xl",align:"center",children:"Drag 'n' drop, or click to select files"})]})),f.length>0&&(0,a.jsx)(o.hJ,{margin:"xl 0",showPaginate:!0,children:f.map((function(e,n){return(0,a.jsx)(o.Ee,{src:e.src},n)}))}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Pick up report"}),(0,a.jsx)("textarea",{name:"report",value:c.report,onChange:A}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Diesel Reading"}),(0,a.jsxs)(o.kC,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,a.jsx)("input",{style:{width:"100%"},name:"diesel",value:c.diesel,onChange:A,type:"range",min:"0",max:null===O||void 0===O?void 0:O.diesel}),(0,a.jsxs)(o.xv,{style:{width:"30px"},weight:"bold",scale:"m",align:"right",children:[c.diesel,"L"]})]}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Hours Reading"}),(0,a.jsx)(o.II,{name:"hours",type:"number",value:c.hours.toString(),onChange:A}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Office Notes"}),c.officeNotes.map((function(e,n){return(0,a.jsxs)(o.kC,{flexDirection:"row",margin:"xl 0 0 0",children:[(0,a.jsx)("input",{type:"checkbox",name:"officeNotes"+n,onChange:A,defaultChecked:e.checked,id:"officeNotes"+n}),(0,a.jsx)("label",{style:{marginLeft:"10px"},htmlFor:"officeNotes"+n,children:e.text})]},n)}))]})]})}function xe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function he(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function pe(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){he(a,r,i,o,s,"next",e)}function s(e){he(a,r,i,o,s,"throw",e)}o(void 0)}))}}function me(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ge(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){me(e,n,t[n])}))}return e}function ve(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return xe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xe(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e){var n=e.open,t=e.setOpen,r=(e.data,(0,b.I0)()),s=(0,u.useState)({destination:"",date:"",report:"",officeNotes:[],diesel:0,hours:0,refuel:0,confirmed:!1}),c=s[0],l=s[1],d=(0,u.useState)([]),f=d[0],x=d[1],h=(0,u.useState)({front:null,rightSide:null,leftSide:null,back:null,fuelGuage:null,hoursReading:null}),p=h[0],m=h[1],g=(0,u.useState)(!1),v=g[0],P=g[1],O=(0,b.v9)(y.QU),S=(0,u.useCallback)((function(e){e.map((function(e,n){var t=new FileReader;return t.onload=function(e){x((function(t){return ve(t).concat([{id:n,src:e.target.result}])}))},t.readAsDataURL(e),e}))}),[]),N=(0,te.uI)({onDrop:S}),D=N.acceptedFiles,I=N.getRootProps,R=N.getInputProps;(0,u.useEffect)((function(){if(n&&null!==O){var e,t=O.table.find((function(e,n){if(e.status===w.eD.DROP_OFF)return{date:e.date,destination:e.destination,officeNotes:e.officeNotes,index:n}}));if(void 0===t)return;l((function(n){return ge({},n,{date:t.date,destination:t.destination,officeNotes:null!==(e=t.officeNotes)&&void 0!==e?e:[]})}))}}),[O,n]),(0,_.Z)(function(){var e=pe(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v||null===O){e.next=8;break}return e.next=3,(0,j.T0)(O.id,O.table);case 3:P(!1),x([]),l({destination:"",date:"",report:"",officeNotes:[],diesel:0,hours:0,refuel:0,confirmed:!1}),m({front:null,rightSide:null,leftSide:null,back:null,fuelGuage:null,hoursReading:null}),D.splice(0,D.length);case 8:if(!n()){e.next=10;break}return e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[v]);var A=function(e){var n=e.target,t=n.name,r=n.value,i=n.checked;if(t.includes("officeNotes")){var a=Number(t.replace("officeNotes",""));l((function(e){return ge({},e,{officeNotes:e.officeNotes.map((function(e,n){return n===a?ge({},e,{checked:i}):e}))})}))}else switch(t){case"diesel":case"hours":l((function(e){return ge({},e,me({},t,parseInt(r)))}));break;default:l((function(e){return ge({},e,me({},t,r))}))}},E=function(){var e=pe(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.officeNotes.map((function(e){return e.checked})).includes(!1)){e.next=3;break}return C.ZP.error("Accept the office note!"),e.abrupt("return",!0);case 3:if(!Object.values(p).map((function(e){return null===e})).includes(!0)){e.next=6;break}return C.ZP.error("Please upload all Pictures"),e.abrupt("return",!0);case 6:return e.next=8,(0,re.Zt)(p,"assets/".concat(null===O||void 0===O?void 0:O.name,"/images/dropoff-").concat(c.date,"/pictures/drop-off-").concat(c.date));case 8:return n=e.sent,e.next=11,(0,re.Uv)(D,"assets/".concat(null===O||void 0===O?void 0:O.name,"/images/dropoff-").concat(c.date,"/additionalImages/drop-off-").concat(c.date,"-").concat((0,k.Z)()));case 11:if(t=e.sent,void 0!=n&&void 0!=t){e.next=15;break}return C.ZP.error("Could not upload Images!"),e.abrupt("return",!0);case 15:return r((0,y.E0)({tableContent:{date:c.date,destination:c.destination,status:w.eD.DROPEDOFF,images:n,additionalImages:t,diesel:c.diesel,hours:c.hours,officeNotes:c.officeNotes,report:c.report,confirmed:!0}})),P(!0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(e){var n=e.name,t=(e.index,(0,u.useRef)(null));return(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,a.jsx)(o.JO,{style:p[n]?{}:{visibility:"hidden"},padding:"m",pointer:!0,icon:"cross",onClick:function(){return m((function(e){return ge({},e,me({},n,null))})),void(t.current&&(t.current.value=""))}}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,a.jsxs)(o.xv,{margin:"0 l 0 0",children:[n,":"]}),(0,a.jsx)("img",{src:p[n]?URL.createObjectURL(p[n]):"",width:40,height:40,style:p[n]?{borderRadius:"5px",margin:"5px",objectFit:"cover"}:{display:"none"}})]}),(0,a.jsx)("input",{style:{width:"200px",backgroundColor:"var(--bg300)"},ref:t,type:"file",onChange:function(e){m((function(e){return ge({},e,me({},n,t.current.files[0]))}))}})]})};return(0,a.jsxs)(o.u_,{open:n,onClose:function(){t(!1)},type:"confirm",onConfirm:pe(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e)}))),children:[(0,a.jsx)(o.xv,{weight:"bold",scale:"xl",children:"Drop off"}),(0,a.jsxs)(o.kC,{children:[(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Address"}),(0,a.jsx)(o.xv,{weight:"bold",children:c.destination}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Date"}),(0,a.jsx)(o.xv,{weight:"bold",children:c.date}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Pictures"}),Object.keys(p).map((function(e,n){return(0,a.jsx)(Z,{name:e,index:n},e)})),(0,a.jsx)(o.xv,{scale:"s",children:"Additional Pictures"}),(0,a.jsxs)("div",ge({},I({className:"dropzone"}),{style:{border:"2px dashed var(--text300)",padding:"10px",borderRadius:"var(--borderRadius)"},children:[(0,a.jsx)("input",ge({},R())),(0,a.jsx)(o.xv,{padding:"xl",align:"center",children:"Drag 'n' drop, or click to select files"})]})),f.length>0&&(0,a.jsx)(o.hJ,{margin:"xl 0",showPaginate:!0,children:f.map((function(e,n){return(0,a.jsx)(o.Ee,{src:e.src},n)}))}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Drop off report"}),(0,a.jsx)("textarea",{name:"report",value:c.report,onChange:A}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Diesel Reading"}),(0,a.jsxs)(o.kC,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,a.jsx)("input",{style:{width:"100%"},name:"diesel",value:c.diesel,onChange:A,type:"range",min:"0",max:null===O||void 0===O?void 0:O.diesel}),(0,a.jsxs)(o.xv,{style:{width:"30px"},weight:"bold",scale:"m",align:"right",children:[c.diesel,"L"]})]}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Hours Reading"}),(0,a.jsx)(o.II,{name:"hours",type:"number",value:c.hours.toString(),onChange:A}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",weight:"bold",children:"*Refuel before dropping off"}),(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",children:[(0,a.jsx)(o.II,{name:"refuel",type:"number",value:c.refuel.toString(),onChange:A}),(0,a.jsx)(o.xv,{style:{marginLeft:5},children:"Ls"})]}),(0,a.jsx)(o.xv,{margin:"xl 0 m 0",scale:"s",children:"Office Notes"}),c.officeNotes.map((function(e,n){return(0,a.jsxs)(o.kC,{flexDirection:"row",margin:"xl 0 0 0",children:[(0,a.jsx)("input",{type:"checkbox",name:"officeNotes"+n,onChange:A,defaultChecked:e.checked,id:"officeNotes"+n}),(0,a.jsx)("label",{style:{marginLeft:"10px"},htmlFor:"officeNotes"+n,children:e.text})]},n)}))]})]})}function be(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,i)}function ye(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){be(a,r,i,o,s,"next",e)}function s(e){be(a,r,i,o,s,"throw",e)}o(void 0)}))}}function we(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ke(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){we(e,n,t[n])}))}return e}function Ce(){var e=(0,b.I0)(),n=(0,c.useRouter)(),r=n.query.id,x=(0,u.useState)(!1),p=x[0],m=x[1],g=(0,u.useState)(!1),v=g[0],k=g[1],C=(0,u.useState)({pickup:!0,dropoff:!0}),P=C[0],O=C[1],S=(0,b.v9)(y.QU);(0,u.useEffect)((function(){if(r){var n=function(){var n=ye(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,ne.QT)((0,ne.JU)((0,ne.ad)(),"assets",r)).then((function(n){var t=n.data();t&&(D(t),e((0,y.WH)({asset:ke({id:r||"",name:t.name||"",imageUrl:t.imageUrl||"",table:t.table||[],serialNumber:t.sn||"",location:t.location||{long:42.9150826,lat:-79.4913604},diesel:t.diesel||"",engine:t.engine||w.BV.STOPED,machineHours:t.machineHours||""},n.data())})))}));case 2:n.sent;case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}}),[r]),(0,u.useEffect)((function(){if(S){var e=S.table.find((function(e,n){return e.status===w.eD.DROP_OFF})),n=S.table.find((function(e,n){return e.status===w.eD.PICKUP}));O({pickup:!n,dropoff:!e})}}),[null===S||void 0===S?void 0:S.table]);var N=function(e){return e>13e3?w.BV.RUNNING:w.BV.STOPED},D=function(){var n=ye(i().mark((function n(t){var a,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,j.cH)(null===t||void 0===t?void 0:t.serialNumber);case 2:if(a=n.sent,o=t,console.log(a),void 0!==a){n.next=7;break}return n.abrupt("return");case 7:if(a.latitude===o.location.lat&&a.longitude===o.location.long&&a.engineHours===o.engineHours){n.next=10;break}return n.next=10,(0,j.pM)(r,{location:{long:a.longitude,lat:a.latitude},engine:N(a.voltage),machineHours:a.engineHours});case 10:e((0,y.WH)({asset:ke({},o,{location:{long:a.longitude,lat:a.latitude},engine:N(a.voltage),machineHours:a.engineHours||0})}));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),I=(0,s.default)((function(){return Promise.all([t.e(269),t.e(284)]).then(t.bind(t,7284))}),{loadableGenerated:{webpack:function(){return[7284]}},ssr:!1});return S&&(0,a.jsxs)("div",{className:h().asset,children:[(0,a.jsx)(o.kC,{alignItems:"center",justifyContent:"center",onClick:function(){e((0,y.WH)({asset:null})),n.back()},className:h().backButton,children:(0,a.jsx)(o.JO,{icon:"arrow"})}),(0,a.jsxs)("div",{className:h().map,children:[(0,a.jsx)(I,{}),(0,a.jsx)("div",{className:h().gradient})]}),(0,a.jsx)(o.Ee,{_class:h().image,src:S.imageUrl}),(0,a.jsxs)(o.kC,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",_class:h().nameWrapper,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.xv,{weight:"bold",scale:"xl",children:S.name}),(0,a.jsxs)(o.xv,{weight:"light",children:["S/N: ",S.serialNumber]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.zx,{onClick:function(){m(!0)},scale:"l",primary:!0,disabled:P.pickup,children:"Pick up"}),(0,a.jsx)(o.zx,{onClick:function(){k(!0)},scale:"l",margin:"m 0 m m",disabled:P.dropoff,children:"Drop off"})]})]}),(0,a.jsx)(o.LZ,{padding:"xl 0"}),(0,a.jsxs)(o.mQ,{id:"assetTabs",_class:h().tabs,children:[(0,a.jsxs)(o.TX,{padding:"m",children:[(0,a.jsx)(o.OK,{margin:"0 m 0 0",index:0,children:"Overview"}),(0,a.jsx)(o.OK,{margin:"0 m 0 0",index:1,children:"Service"}),(0,a.jsx)(o.OK,{margin:"0 m 0 0",index:2,children:"Gallery"}),(0,a.jsx)(o.OK,{margin:"0 m 0 0",index:3,children:"Contracts"}),(0,a.jsx)(o.OK,{margin:"0 m 0 0",index:4,children:"Availibility"})]}),(0,a.jsx)(o.nU,{margin:"0 0 xl 0",padding:"xl 0 0 0",children:[(0,a.jsx)(X,{},1),(0,a.jsx)(ee,{},2),(0,a.jsx)(f,{},3),(0,a.jsx)(d,{},4),(0,a.jsx)(l,{},5)]})]}),(0,a.jsx)(fe,{data:S,open:p,setOpen:m}),(0,a.jsx)(je,{data:S,open:v,setOpen:k})]})}},7537:function(e){e.exports={icon:"PickupDropoff_icon___WLbO"}},7320:function(e){e.exports={table:"Table_table__hBmSM",icon:"Table_icon__DBgtw",pickedUpCell:"Table_pickedUpCell__fYF0W",dropedOffCell:"Table_dropedOffCell__ANz9E"}}},function(e){e.O(0,[158,339,459,774,888,179],(function(){return n=5374,e(e.s=n);var n}));var n=e.O();_N_E=n}]);